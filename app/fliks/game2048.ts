// Full standalone HTML for 2048 Game
const get2048HTML = () => {
  return '<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <title>2048 Game</title>\n  <meta name=\"viewport\" content=\"width=device-width,height=device-height,user-scalable=no,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0\">\n  <style>\n\nhtml, body {\n  margin: 0;\n  padding: 0;\n  background: #faf8ef;\n  color: #776e65;\n  font-family: \"Clear Sans\", \"Helvetica Neue\", Arial, sans-serif;\n  font-size: 18px;\n  height: 100vh;\n  width: 100%;\n  overflow: hidden;\n}\n\n.container {\n  width: 500px;\n  margin: 0;\n  padding: 0;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n}\n\n.heading {\n  margin-bottom: 10px;\n  width: 100%;\n}\n\n.game-container {\n  margin-top: -20px;\n}\nhtml, body {\n  margin: 0;\n  padding: 0;\n  background: #faf8ef;\n  color: #776e65;\n  font-family: \"Clear Sans\", \"Helvetica Neue\", Arial, sans-serif;\n  font-size: 18px;\n}\n\n\n\n.heading:after {\n  content: \"\";\n  display: block;\n  clear: both;\n}\n\nh1.title {\n  font-size: 80px;\n  font-weight: bold;\n  margin: 0;\n  display: block;\n  float: left;\n}\n\n@-webkit-keyframes move-up {\n  0% {\n    top: 25px;\n    opacity: 1;\n  }\n\n  100% {\n    top: -50px;\n    opacity: 0;\n  }\n}\n@-moz-keyframes move-up {\n  0% {\n    top: 25px;\n    opacity: 1;\n  }\n\n  100% {\n    top: -50px;\n    opacity: 0;\n  }\n}\n@keyframes move-up {\n  0% {\n    top: 25px;\n    opacity: 1;\n  }\n\n  100% {\n    top: -50px;\n    opacity: 0;\n  }\n}\n.score-container {\n  position: relative;\n  float: right;\n  background: #bbada0;\n  padding: 15px 25px;\n  font-size: 25px;\n  height: 25px;\n  line-height: 47px;\n  font-weight: bold;\n  border-radius: 3px;\n  color: white;\n  margin-top: 8px;\n}\n.score-container:after {\n  position: absolute;\n  width: 100%;\n  top: 10px;\n  left: 0;\n  content: \"Score\";\n  text-transform: uppercase;\n  font-size: 13px;\n  line-height: 13px;\n  text-align: center;\n  color: #eee4da;\n}\n.score-container .score-addition {\n  position: absolute;\n  right: 30px;\n  color: red;\n  font-size: 25px;\n  line-height: 25px;\n  font-weight: bold;\n  color: rgba(119, 110, 101, 0.9);\n  z-index: 100;\n  -webkit-animation: move-up 600ms ease-in;\n  -moz-animation: move-up 600ms ease-in;\n  -webkit-animation-fill-mode: both;\n  -moz-animation-fill-mode: both;\n}\n\np {\n  margin-top: 0;\n  margin-bottom: 10px;\n  line-height: 1.65;\n}\n\na {\n  color: #776e65;\n  font-weight: bold;\n  text-decoration: underline;\n  cursor: pointer;\n}\n\nstrong.important {\n  text-transform: uppercase;\n}\n\nhr {\n  border: none;\n  border-bottom: 1px solid #d8d4d0;\n  margin-top: 20px;\n  margin-bottom: 30px;\n}\n\n\n\n@-webkit-keyframes fade-in {\n  0% {\n    opacity: 0;\n  }\n\n  100% {\n    opacity: 1;\n  }\n}\n@-moz-keyframes fade-in {\n  0% {\n    opacity: 0;\n  }\n\n  100% {\n    opacity: 1;\n  }\n}\n@keyframes fade-in {\n  0% {\n    opacity: 0;\n  }\n\n  100% {\n    opacity: 1;\n  }\n}\n.game-container {\n  margin-top: 10px;\n  position: relative;\n  padding: 15px;\n  cursor: default;\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  background: #bbada0;\n  border-radius: 6px;\n  width: 31.3pc;\n  height: 31.3pc;\n  /* -webkit-box-sizing: border-box; */\n  -moz-box-sizing: border-box;\n  box-sizing: border-box;\n}\n.game-container .game-message {\n  display: none;\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  background: rgba(238, 228, 218, 0.5);\n  z-index: 100;\n  text-align: center;\n  -webkit-animation: fade-in 800ms ease 1200ms;\n  -moz-animation: fade-in 800ms ease 1200ms;\n  -webkit-animation-fill-mode: both;\n  -moz-animation-fill-mode: both;\n}\n.game-container .game-message p {\n  font-size: 60px;\n  font-weight: bold;\n  height: 60px;\n  line-height: 60px;\n  margin-top: 222px;\n}\n.game-container .game-message .lower {\n  display: block;\n  margin-top: 59px;\n}\n.game-container .game-message a {\n  display: inline-block;\n  background: #8f7a66;\n  border-radius: 3px;\n  padding: 0 20px;\n  text-decoration: none;\n  color: #f9f6f2;\n  height: 40px;\n  line-height: 42px;\n  margin-left: 9px;\n}\n.game-container .game-message.game-won {\n  background: rgba(237, 194, 46, 0.5);\n  color: #f9f6f2;\n}\n.game-container .game-message.game-won, .game-container .game-message.game-over {\n  display: block;\n}\n\n.grid-container {\n  position: absolute;\n  z-index: 1;\n}\n\n.grid-row {\n  margin-bottom: 15px;\n}\n.grid-row:last-child {\n  margin-bottom: 0;\n}\n.grid-row:after {\n  content: \"\";\n  display: block;\n  clear: both;\n}\n\n.grid-cell {\n  width: 106.25px;\n  height: 106.25px;\n  margin-right: 15px;\n  float: left;\n  border-radius: 3px;\n  background: rgba(238, 228, 218, 0.35);\n}\n.grid-cell:last-child {\n  margin-right: 0;\n}\n\n.tile-container {\n  position: absolute;\n  z-index: 2;\n}\n\n.tile {\n  width: 106.25px;\n  height: 106.25px;\n  line-height: 106.25px;\n}\n.tile.tile-position-1-1 {\n  position: absolute;\n  left: 0px;\n  top: 0px;\n}\n.tile.tile-position-1-2 {\n  position: absolute;\n  left: 0px;\n  top: 121px;\n}\n.tile.tile-position-1-3 {\n  position: absolute;\n  left: 0px;\n  top: 243px;\n}\n.tile.tile-position-1-4 {\n  position: absolute;\n  left: 0px;\n  top: 364px;\n}\n.tile.tile-position-2-1 {\n  position: absolute;\n  left: 121px;\n  top: 0px;\n}\n.tile.tile-position-2-2 {\n  position: absolute;\n  left: 121px;\n  top: 121px;\n}\n.tile.tile-position-2-3 {\n  position: absolute;\n  left: 121px;\n  top: 243px;\n}\n.tile.tile-position-2-4 {\n  position: absolute;\n  left: 121px;\n  top: 364px;\n}\n.tile.tile-position-3-1 {\n  position: absolute;\n  left: 243px;\n  top: 0px;\n}\n.tile.tile-position-3-2 {\n  position: absolute;\n  left: 243px;\n  top: 121px;\n}\n.tile.tile-position-3-3 {\n  position: absolute;\n  left: 243px;\n  top: 243px;\n}\n.tile.tile-position-3-4 {\n  position: absolute;\n  left: 243px;\n  top: 364px;\n}\n.tile.tile-position-4-1 {\n  position: absolute;\n  left: 364px;\n  top: 0px;\n}\n.tile.tile-position-4-2 {\n  position: absolute;\n  left: 364px;\n  top: 121px;\n}\n.tile.tile-position-4-3 {\n  position: absolute;\n  left: 364px;\n  top: 243px;\n}\n.tile.tile-position-4-4 {\n  position: absolute;\n  left: 364px;\n  top: 364px;\n}\n\n.tile {\n  border-radius: 3px;\n  background: #eee4da;\n  text-align: center;\n  font-weight: bold;\n  z-index: 10;\n  font-size: 55px;\n  -webkit-transition: 100ms ease-in-out;\n  -moz-transition: 100ms ease-in-out;\n  -webkit-transition-property: top, left;\n  -moz-transition-property: top, left;\n}\n.tile.tile-2 {\n  background: #eee4da;\n  box-shadow: 0 0 30px 10px rgba(243, 215, 116, 0), inset 0 0 0 1px rgba(255, 255, 255, 0);\n}\n.tile.tile-4 {\n  background: #ede0c8;\n  box-shadow: 0 0 30px 10px rgba(243, 215, 116, 0), inset 0 0 0 1px rgba(255, 255, 255, 0);\n}\n.tile.tile-8 {\n  color: #f9f6f2;\n  background: #f2b179;\n}\n.tile.tile-16 {\n  color: #f9f6f2;\n  background: #f59563;\n}\n.tile.tile-32 {\n  color: #f9f6f2;\n  background: #f67c5f;\n}\n.tile.tile-64 {\n  color: #f9f6f2;\n  background: #f65e3b;\n}\n.tile.tile-128 {\n  color: #f9f6f2;\n  background: #edcf72;\n  box-shadow: 0 0 30px 10px rgba(243, 215, 116, 0.2381), inset 0 0 0 1px rgba(255, 255, 255, 0.14286);\n  font-size: 45px;\n}\n@media screen and (max-width: 480px) {\n  .tile.tile-128 {\n    font-size: 25px;\n  }\n}\n.tile.tile-256 {\n  color: #f9f6f2;\n  background: #edcc61;\n  box-shadow: 0 0 30px 10px rgba(243, 215, 116, 0.31746), inset 0 0 0 1px rgba(255, 255, 255, 0.19048);\n  font-size: 45px;\n}\n@media screen and (max-width: 480px) {\n  .tile.tile-256 {\n    font-size: 25px;\n  }\n}\n.tile.tile-512 {\n  color: #f9f6f2;\n  background: #edc850;\n  box-shadow: 0 0 30px 10px rgba(243, 215, 116, 0.39683), inset 0 0 0 1px rgba(255, 255, 255, 0.2381);\n  font-size: 45px;\n}\n@media screen and (max-width: 480px) {\n  .tile.tile-512 {\n    font-size: 25px;\n  }\n}\n.tile.tile-1024 {\n  color: #f9f6f2;\n  background: #edc53f;\n  box-shadow: 0 0 30px 10px rgba(243, 215, 115, 0.5), inset 0 0 0 1px rgba(255, 255, 255, 0.2);\n  font-size: 35px;\n}\n@media screen and (max-width: 480px) {\n  .tile.tile-1024 {\n    font-size: 15px;\n  }\n}\n.tile.tile-2048 {\n  color: #f9f6f2;\n  background: #edc22e;\n  box-shadow: 0 0 30px 10px rgba(243, 215, 116, 0.55556), inset 0 0 0 1px rgba(255, 255, 255, 0.33333);\n  font-size: 35px;\n}\n@media screen and (max-width: 480px) {\n  .tile.tile-2048 {\n    font-size: 15px;\n  }\n}\n  .tile.tile-4096 {\n    color: #f9f6f2;\n    background: #80A;\n    box-shadow: 0 0 30px 10px rgba(104, 0, 215, 0.2), inset 0 0 0 1px rgba(255, 255, 255, 0.2);\n    font-size: 35px;\n}\n@media screen and (max-width: 480px) {\n  .tile.tile-4096 {\n    font-size: 15px;\n  }\n}\n.tile.tile-8192 {\n    color: #f9f6f2;\n    background: #84C;\n    box-shadow: 0 0 30px 10px rgba(104, 100, 219, 0.2), inset 0 0 0 1px rgba(255, 255, 255, 0.2);\n    font-size: 35px;\n}\n@media screen and (max-width: 480px) {\n  .tile.tile-8192 {\n    font-size: 15px;\n  }\n}\n\n@-webkit-keyframes appear {\n  0% {\n    opacity: 0;\n    -webkit-transform: scale(0);\n    -moz-transform: scale(0);\n  }\n\n  100% {\n    opacity: 1;\n    -webkit-transform: scale(1);\n    -moz-transform: scale(1);\n  }\n}\n@-moz-keyframes appear {\n  0% {\n    opacity: 0;\n    -webkit-transform: scale(0);\n    -moz-transform: scale(0);\n\n  }\n\n  100% {\n    opacity: 1;\n    -webkit-transform: scale(1);\n    -moz-transform: scale(1);\n  }\n}\n@keyframes appear {\n  0% {\n    opacity: 0;\n    -webkit-transform: scale(0);\n    -moz-transform: scale(0);\n  }\n\n  100% {\n    opacity: 1;\n    -webkit-transform: scale(1);\n    -moz-transform: scale(1);\n  }\n}\n.tile-new {\n  -webkit-animation: appear 200ms ease 100ms;\n  -moz-animation: appear 200ms ease 100ms;\n  -webkit-animation-fill-mode: both;\n  -moz-animation-fill-mode: both;\n}\n\n@-webkit-keyframes pop {\n  0% {\n    -webkit-transform: scale(0);\n    -moz-transform: scale(0);\n  }\n\n  50% {\n    -webkit-transform: scale(1.2);\n    -moz-transform: scale(1.2);\n  }\n\n  100% {\n    -webkit-transform: scale(1);\n    -moz-transform: scale(1);\n  }\n}\n@-moz-keyframes pop {\n  0% {\n    -webkit-transform: scale(0);\n    -moz-transform: scale(0);\n  }\n\n  50% {\n    -webkit-transform: scale(1.2);\n    -moz-transform: scale(1.2);\n  }\n\n  100% {\n    -webkit-transform: scale(1);\n    -moz-transform: scale(1);\n  }\n}\n@keyframes pop {\n  0% {\n    -webkit-transform: scale(0);\n    -moz-transform: scale(0);\n  }\n\n  50% {\n    -webkit-transform: scale(1.2);\n    -moz-transform: scale(1.2);\n  }\n\n  100% {\n    -webkit-transform: scale(1);\n    -moz-transform: scale(1);\n  }\n}\n.tile-merged {\n  z-index: 20;\n  -webkit-animation: pop 200ms ease 100ms;\n  -moz-animation: pop 200ms ease 100ms;\n  -webkit-animation-fill-mode: both;\n  -moz-animation-fill-mode: both;\n}\n\n.game-intro {\n  margin-bottom: 0;\n}\n\n.game-explanation {\n  margin-top: 50px;\n}\n\n@media screen and (max-width: 520px) {\n  html, body {\n    font-size: 15px;\n  }\n\n  body {\n    margin: 20px 0;\n    padding: 0 20px;\n  }\n\n  h1.title {\n    font-size: 50px;\n  }\n\n  .container {\n    width: 280px;\n    margin: 0 auto;\n  }\n\n  .score-container {\n    margin-top: 0;\n  }\n\n  .heading {\n    margin-bottom: 10px;\n  }\n\n  .game-container {\n    margin-top: 40px;\n    position: relative;\n    padding: 10px;\n    cursor: default;\n    -webkit-touch-callout: none;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    background: #bbada0;\n    border-radius: 6px;\n    width: 280px;\n    height: 280px;\n    -webkit-box-sizing: border-box;\n    -moz-box-sizing: border-box;\n    box-sizing: border-box;\n  }\n  .game-container .game-message {\n    display: none;\n    position: absolute;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n    background: rgba(238, 228, 218, 0.5);\n    z-index: 100;\n    text-align: center;\n    -webkit-animation: fade-in 800ms ease 1200ms;\n    -moz-animation: fade-in 800ms ease 1200ms;\n    -webkit-animation-fill-mode: both;\n    -moz-animation-fill-mode: both;\n  }\n  .game-container .game-message p {\n    font-size: 60px;\n    font-weight: bold;\n    height: 60px;\n    line-height: 60px;\n    margin-top: 222px;\n  }\n  .game-container .game-message .lower {\n    display: block;\n    margin-top: 59px;\n  }\n  .game-container .game-message a {\n    display: inline-block;\n    background: #8f7a66;\n    border-radius: 3px;\n    padding: 0 20px;\n    text-decoration: none;\n    color: #f9f6f2;\n    height: 40px;\n    line-height: 42px;\n    margin-left: 9px;\n  }\n  .game-container .game-message.game-won {\n    background: rgba(237, 194, 46, 0.5);\n    color: #f9f6f2;\n  }\n  .game-container .game-message.game-won, .game-container .game-message.game-over {\n    display: block;\n  }\n\n  .grid-container {\n    position: absolute;\n    z-index: 1;\n  }\n\n  .grid-row {\n    margin-bottom: 10px;\n  }\n  .grid-row:last-child {\n    margin-bottom: 0;\n  }\n  .grid-row:after {\n    content: \"\";\n    display: block;\n    clear: both;\n  }\n\n  .grid-cell {\n    width: 57.5px;\n    height: 57.5px;\n    margin-right: 10px;\n    float: left;\n    border-radius: 3px;\n    background: rgba(238, 228, 218, 0.35);\n  }\n  .grid-cell:last-child {\n    margin-right: 0;\n  }\n\n  .tile-container {\n    position: absolute;\n    z-index: 2;\n  }\n\n  .tile {\n    width: 57.5px;\n    height: 57.5px;\n    line-height: 57.5px;\n  }\n  .tile.tile-position-1-1 {\n    position: absolute;\n    left: 0px;\n    top: 0px;\n  }\n  .tile.tile-position-1-2 {\n    position: absolute;\n    left: 0px;\n    top: 68px;\n  }\n  .tile.tile-position-1-3 {\n    position: absolute;\n    left: 0px;\n    top: 135px;\n  }\n  .tile.tile-position-1-4 {\n    position: absolute;\n    left: 0px;\n    top: 203px;\n  }\n  .tile.tile-position-2-1 {\n    position: absolute;\n    left: 68px;\n    top: 0px;\n  }\n  .tile.tile-position-2-2 {\n    position: absolute;\n    left: 68px;\n    top: 68px;\n  }\n  .tile.tile-position-2-3 {\n    position: absolute;\n    left: 68px;\n    top: 135px;\n  }\n  .tile.tile-position-2-4 {\n    position: absolute;\n    left: 68px;\n    top: 203px;\n  }\n  .tile.tile-position-3-1 {\n    position: absolute;\n    left: 135px;\n    top: 0px;\n  }\n  .tile.tile-position-3-2 {\n    position: absolute;\n    left: 135px;\n    top: 68px;\n  }\n  .tile.tile-position-3-3 {\n    position: absolute;\n    left: 135px;\n    top: 135px;\n  }\n  .tile.tile-position-3-4 {\n    position: absolute;\n    left: 135px;\n    top: 203px;\n  }\n  .tile.tile-position-4-1 {\n    position: absolute;\n    left: 203px;\n    top: 0px;\n  }\n  .tile.tile-position-4-2 {\n    position: absolute;\n    left: 203px;\n    top: 68px;\n  }\n  .tile.tile-position-4-3 {\n    position: absolute;\n    left: 203px;\n    top: 135px;\n  }\n  .tile.tile-position-4-4 {\n    position: absolute;\n    left: 203px;\n    top: 203px;\n  }\n\n  .game-container {\n    margin-top: 20px;\n  }\n\n  .tile {\n    font-size: 35px;\n  }\n\n  .game-message p {\n    font-size: 30px !important;\n    height: 30px !important;\n    line-height: 30px !important;\n    margin-top: 90px !important;\n  }\n  .game-message .lower {\n    margin-top: 30px !important;\n  }\n  </style>\n</head>\n<body>\n<body>\n<div class=\"container\">\n  <div class=\"heading\">\n    <h1 class=\"title\">2048</h1>\n    <div class=\"score-container\">0</div>\n  </div>\n  <div class=\"game-container\">\n    <div class=\"game-message\">\n      <p>Game over!</p>\n      <div class=\"lower\">\n        <a class=\"retry-button\">Try Again</a>\n      </div>\n    </div>\n    <div class=\"grid-container\">\n      <div class=\"grid-row\">\n        <div class=\"grid-cell\"></div>\n        <div class=\"grid-cell\"></div>\n        <div class=\"grid-cell\"></div>\n        <div class=\"grid-cell\"></div>\n      </div><div class=\"grid-row\">\n        <div class=\"grid-cell\"></div>\n        <div class=\"grid-cell\"></div>\n        <div class=\"grid-cell\"></div>\n        <div class=\"grid-cell\"></div>\n      </div><div class=\"grid-row\">\n        <div class=\"grid-cell\"></div>\n        <div class=\"grid-cell\"></div>\n        <div class=\"grid-cell\"></div>\n        <div class=\"grid-cell\"></div>\n      </div><div class=\"grid-row\">\n        <div class=\"grid-cell\"></div>\n        <div class=\"grid-cell\"></div>\n        <div class=\"grid-cell\"></div>\n        <div class=\"grid-cell\"></div>\n      </div>\n    </div>\n    <div class=\"tile-container\"></div>\n  </div>\n</div>\n</body>\n</html>\n    <script  src=\"./script.js\"></script>\n\n<script>\n// Console forwarding\nconst originalLog = console.log;\nconst originalError = console.error;\nconsole.log = function(...args) {\n  window.ReactNativeWebView?.postMessage(JSON.stringify({ type: \'log\', message: args.join(\' \') }));\n  originalLog.apply(console, args);\n};\nconsole.error = function(...args) {\n  window.ReactNativeWebView?.postMessage(JSON.stringify({ type: \'error\', message: args.join(\' \') }));\n  originalError.apply(console, args);\n};\n\n// Hammer.js library (embedded)\n!function(a,b){\"use strict\";function c(){d.READY||(d.event.determineEventTypes(),d.utils.each(d.gestures,function(a){d.detection.register(a)}),d.event.onTouch(d.DOCUMENT,d.EVENT_MOVE,d.detection.detect),d.event.onTouch(d.DOCUMENT,d.EVENT_END,d.detection.detect),d.READY=!0)}var d=function(a,b){return new d.Instance(a,b||{})};d.defaults={stop_browser_behavior:{userSelect:\"none\",touchAction:\"none\",touchCallout:\"none\",contentZooming:\"none\",userDrag:\"none\",tapHighlightColor:\"rgba(0,0,0,0)\"}},d.HAS_POINTEREVENTS=a.navigator.pointerEnabled||a.navigator.msPointerEnabled,d.HAS_TOUCHEVENTS=\"ontouchstart\"in a,d.MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android|silk/i,d.NO_MOUSEEVENTS=d.HAS_TOUCHEVENTS&&a.navigator.userAgent.match(d.MOBILE_REGEX),d.EVENT_TYPES={},d.DIRECTION_DOWN=\"down\",d.DIRECTION_LEFT=\"left\",d.DIRECTION_UP=\"up\",d.DIRECTION_RIGHT=\"right\",d.POINTER_MOUSE=\"mouse\",d.POINTER_TOUCH=\"touch\",d.POINTER_PEN=\"pen\",d.EVENT_START=\"start\",d.EVENT_MOVE=\"move\",d.EVENT_END=\"end\",d.DOCUMENT=a.document,d.plugins=d.plugins||{},d.gestures=d.gestures||{},d.READY=!1,d.utils={extend:function(a,c,d){for(var e in c)a[e]!==b&&d||(a[e]=c[e]);return a},each:function(a,c,d){var e,f;if(\"forEach\"in a)a.forEach(c,d);else if(a.length!==b){for(e=0,f=a.length;f>e;e++)if(c.call(d,a[e],e,a)===!1)return}else for(e in a)if(a.hasOwnProperty(e)&&c.call(d,a[e],e,a)===!1)return},hasParent:function(a,b){for(;a;){if(a==b)return!0;a=a.parentNode}return!1},getCenter:function(a){var b=[],c=[];return d.utils.each(a,function(a){b.push(\"undefined\"!=typeof a.clientX?a.clientX:a.pageX),c.push(\"undefined\"!=typeof a.clientY?a.clientY:a.pageY)}),{pageX:(Math.min.apply(Math,b)+Math.max.apply(Math,b))/2,pageY:(Math.min.apply(Math,c)+Math.max.apply(Math,c))/2}},getVelocity:function(a,b,c){return{x:Math.abs(b/a)||0,y:Math.abs(c/a)||0}},getAngle:function(a,b){var c=b.pageY-a.pageY,d=b.pageX-a.pageX;return 180*Math.atan2(c,d)/Math.PI},getDirection:function(a,b){var c=Math.abs(a.pageX-b.pageX),e=Math.abs(a.pageY-b.pageY);return c>=e?a.pageX-b.pageX>0?d.DIRECTION_LEFT:d.DIRECTION_RIGHT:a.pageY-b.pageY>0?d.DIRECTION_UP:d.DIRECTION_DOWN},getDistance:function(a,b){var c=b.pageX-a.pageX,d=b.pageY-a.pageY;return Math.sqrt(c*c+d*d)},getScale:function(a,b){return a.length>=2&&b.length>=2?this.getDistance(b[0],b[1])/this.getDistance(a[0],a[1]):1},getRotation:function(a,b){return a.length>=2&&b.length>=2?this.getAngle(b[1],b[0])-this.getAngle(a[1],a[0]):0},isVertical:function(a){return a==d.DIRECTION_UP||a==d.DIRECTION_DOWN},stopDefaultBrowserBehavior:function(a,b){b&&a&&a.style&&(d.utils.each([\"webkit\",\"khtml\",\"moz\",\"Moz\",\"ms\",\"o\",\"\"],function(c){d.utils.each(b,function(b){c&&(b=c+b.substring(0,1).toUpperCase()+b.substring(1)),b in a.style&&(a.style[b]=b)})}),\"none\"==b.userSelect&&(a.onselectstart=function(){return!1}),\"none\"==b.userDrag&&(a.ondragstart=function(){return!1}))}},d.Instance=function(a,b){var e=this;return c(),this.element=a,this.enabled=!0,this.options=d.utils.extend(d.utils.extend({},d.defaults),b||{}),this.options.stop_browser_behavior&&d.utils.stopDefaultBrowserBehavior(this.element,this.options.stop_browser_behavior),d.event.onTouch(a,d.EVENT_START,function(a){e.enabled&&d.detection.startDetect(e,a)}),this},d.Instance.prototype={on:function(a,b){var c=a.split(\" \");return d.utils.each(c,function(a){this.element.addEventListener(a,b,!1)},this),this},off:function(a,b){var c=a.split(\" \");return d.utils.each(c,function(a){this.element.removeEventListener(a,b,!1)},this),this},trigger:function(a,b){b||(b={});var c=d.DOCUMENT.createEvent(\"Event\");c.initEvent(a,!0,!0),c.gesture=b;var e=this.element;return d.utils.hasParent(b.target,e)&&(e=b.target),e.dispatchEvent(c),this},enable:function(a){return this.enabled=a,this}};var e=null,f=!1,g=!1;d.event={bindDom:function(a,b,c){var e=b.split(\" \");d.utils.each(e,function(b){a.addEventListener(b,c,!1)})},onTouch:function(a,b,c){var h=this;this.bindDom(a,d.EVENT_TYPES[b],function(i){var j=i.type.toLowerCase();if(!j.match(/mouse/)||!g){j.match(/touch/)||j.match(/pointerdown/)||j.match(/mouse/)&&1===i.which?f=!0:j.match(/mouse/)&&!i.which&&(f=!1),j.match(/touch|pointer/)&&(g=!0);var k=0;f&&(d.HAS_POINTEREVENTS&&b!=d.EVENT_END?k=d.PointerEvent.updatePointer(b,i):j.match(/touch/)?k=i.touches.length:g||(k=j.match(/up/)?0:1),k>0&&b==d.EVENT_END?b=d.EVENT_MOVE:k||(b=d.EVENT_END),(k||null===e)&&(e=i),c.call(d.detection,h.collectEventData(a,b,h.getTouchList(e,b),i)),d.HAS_POINTEREVENTS&&b==d.EVENT_END&&(k=d.PointerEvent.updatePointer(b,i))),k||(e=null,f=!1,g=!1,d.PointerEvent.reset())}})},determineEventTypes:function(){var a;a=d.HAS_POINTEREVENTS?d.PointerEvent.getEvents():d.NO_MOUSEEVENTS?[\"touchstart\",\"touchmove\",\"touchend touchcancel\"]:[\"touchstart mousedown\",\"touchmove mousemove\",\"touchend touchcancel mouseup\"],d.EVENT_TYPES[d.EVENT_START]=a[0],d.EVENT_TYPES[d.EVENT_MOVE]=a[1],d.EVENT_TYPES[d.EVENT_END]=a[2]},getTouchList:function(a){return d.HAS_POINTEREVENTS?d.PointerEvent.getTouchList():a.touches?a.touches:(a.identifier=1,[a])},collectEventData:function(a,b,c,e){var f=d.POINTER_TOUCH;return(e.type.match(/mouse/)||d.PointerEvent.matchType(d.POINTER_MOUSE,e))&&(f=d.POINTER_MOUSE),{center:d.utils.getCenter(c),timeStamp:(new Date).getTime(),target:e.target,touches:c,eventType:b,pointerType:f,srcEvent:e,preventDefault:function(){this.srcEvent.preventManipulation&&this.srcEvent.preventManipulation(),this.srcEvent.preventDefault&&this.srcEvent.preventDefault()},stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return d.detection.stopDetect()}}}},d.PointerEvent={pointers:{},getTouchList:function(){var a=this,b=[];return d.utils.each(a.pointers,function(a){b.push(a)}),b},updatePointer:function(a,b){return a==d.EVENT_END?this.pointers={}:(b.identifier=b.pointerId,this.pointers[b.pointerId]=b),Object.keys(this.pointers).length},matchType:function(a,b){if(!b.pointerType)return!1;var c=b.pointerType,e={};return e[d.POINTER_MOUSE]=c===b.MSPOINTER_TYPE_MOUSE||c===d.POINTER_MOUSE,e[d.POINTER_TOUCH]=c===b.MSPOINTER_TYPE_TOUCH||c===d.POINTER_TOUCH,e[d.POINTER_PEN]=c===b.MSPOINTER_TYPE_PEN||c===d.POINTER_PEN,e[a]},getEvents:function(){return[\"pointerdown MSPointerDown\",\"pointermove MSPointerMove\",\"pointerup pointercancel MSPointerUp MSPointerCancel\"]},reset:function(){this.pointers={}}},d.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(a,b){this.current||(this.stopped=!1,this.current={inst:a,startEvent:d.utils.extend({},b),lastEvent:!1,name:\"\"},this.detect(b))},detect:function(a){if(this.current&&!this.stopped){a=this.extendEventData(a);var b=this.current.inst.options;return d.utils.each(this.gestures,function(c){return this.stopped||b[c.name]===!1||c.handler.call(c,a,this.current.inst)!==!1?void 0:(this.stopDetect(),!1)},this),this.current&&(this.current.lastEvent=a),a.eventType==d.EVENT_END&&!a.touches.length-1&&this.stopDetect(),a}},stopDetect:function(){this.previous=d.utils.extend({},this.current),this.current=null,this.stopped=!0},extendEventData:function(a){var b=this.current.startEvent;!b||a.touches.length==b.touches.length&&a.touches!==b.touches||(b.touches=[],d.utils.each(a.touches,function(a){b.touches.push(d.utils.extend({},a))}));var c,e,f=a.timeStamp-b.timeStamp,g=a.center.pageX-b.center.pageX,h=a.center.pageY-b.center.pageY,i=d.utils.getVelocity(f,g,h);return\"end\"===a.eventType?(c=this.current.lastEvent&&this.current.lastEvent.interimAngle,e=this.current.lastEvent&&this.current.lastEvent.interimDirection):(c=this.current.lastEvent&&d.utils.getAngle(this.current.lastEvent.center,a.center),e=this.current.lastEvent&&d.utils.getDirection(this.current.lastEvent.center,a.center)),d.utils.extend(a,{deltaTime:f,deltaX:g,deltaY:h,velocityX:i.x,velocityY:i.y,distance:d.utils.getDistance(b.center,a.center),angle:d.utils.getAngle(b.center,a.center),interimAngle:c,direction:d.utils.getDirection(b.center,a.center),interimDirection:e,scale:d.utils.getScale(b.touches,a.touches),rotation:d.utils.getRotation(b.touches,a.touches),startEvent:b}),a},register:function(a){var c=a.defaults||{};return c[a.name]===b&&(c[a.name]=!0),d.utils.extend(d.defaults,c,!0),a.index=a.index||1e3,this.gestures.push(a),this.gestures.sort(function(a,b){return a.index<b.index?-1:a.index>b.index?1:0}),this.gestures}},d.gestures.Drag={name:\"drag\",index:50,defaults:{drag_min_distance:10,correct_for_drag_min_distance:!0,drag_max_touches:1,drag_block_horizontal:!1,drag_block_vertical:!1,drag_lock_to_axis:!1,drag_lock_min_distance:25},triggered:!1,handler:function(a,b){if(d.detection.current.name!=this.name&&this.triggered)return b.trigger(this.name+\"end\",a),this.triggered=!1,void 0;if(!(b.options.drag_max_touches>0&&a.touches.length>b.options.drag_max_touches))switch(a.eventType){case d.EVENT_START:this.triggered=!1;break;case d.EVENT_MOVE:if(a.distance<b.options.drag_min_distance&&d.detection.current.name!=this.name)return;if(d.detection.current.name!=this.name&&(d.detection.current.name=this.name,b.options.correct_for_drag_min_distance&&a.distance>0)){var c=Math.abs(b.options.drag_min_distance/a.distance);d.detection.current.startEvent.center.pageX+=a.deltaX*c,d.detection.current.startEvent.center.pageY+=a.deltaY*c,a=d.detection.extendEventData(a)}(d.detection.current.lastEvent.drag_locked_to_axis||b.options.drag_lock_to_axis&&b.options.drag_lock_min_distance<=a.distance)&&(a.drag_locked_to_axis=!0);var e=d.detection.current.lastEvent.direction;a.drag_locked_to_axis&&e!==a.direction&&(a.direction=d.utils.isVertical(e)?a.deltaY<0?d.DIRECTION_UP:d.DIRECTION_DOWN:a.deltaX<0?d.DIRECTION_LEFT:d.DIRECTION_RIGHT),this.triggered||(b.trigger(this.name+\"start\",a),this.triggered=!0),b.trigger(this.name,a),b.trigger(this.name+a.direction,a),(b.options.drag_block_vertical&&d.utils.isVertical(a.direction)||b.options.drag_block_horizontal&&!d.utils.isVertical(a.direction))&&a.preventDefault();break;case d.EVENT_END:this.triggered&&b.trigger(this.name+\"end\",a),this.triggered=!1}}},d.gestures.Hold={name:\"hold\",index:10,defaults:{hold_timeout:500,hold_threshold:1},timer:null,handler:function(a,b){switch(a.eventType){case d.EVENT_START:clearTimeout(this.timer),d.detection.current.name=this.name,this.timer=setTimeout(function(){\"hold\"==d.detection.current.name&&b.trigger(\"hold\",a)},b.options.hold_timeout);break;case d.EVENT_MOVE:a.distance>b.options.hold_threshold&&clearTimeout(this.timer);break;case d.EVENT_END:clearTimeout(this.timer)}}},d.gestures.Release={name:\"release\",index:1/0,handler:function(a,b){a.eventType==d.EVENT_END&&b.trigger(this.name,a)}},d.gestures.Swipe={name:\"swipe\",index:40,defaults:{swipe_min_touches:1,swipe_max_touches:1,swipe_velocity:.7},handler:function(a,b){if(a.eventType==d.EVENT_END){if(b.options.swipe_max_touches>0&&a.touches.length<b.options.swipe_min_touches&&a.touches.length>b.options.swipe_max_touches)return;(a.velocityX>b.options.swipe_velocity||a.velocityY>b.options.swipe_velocity)&&(b.trigger(this.name,a),b.trigger(this.name+a.direction,a))}}},d.gestures.Tap={name:\"tap\",index:100,defaults:{tap_max_touchtime:250,tap_max_distance:10,tap_always:!0,doubletap_distance:20,doubletap_interval:300},handler:function(a,b){if(a.eventType==d.EVENT_END&&\"touchcancel\"!=a.srcEvent.type){var c=d.detection.previous,e=!1;if(a.deltaTime>b.options.tap_max_touchtime||a.distance>b.options.tap_max_distance)return;c&&\"tap\"==c.name&&a.timeStamp-c.lastEvent.timeStamp<b.options.doubletap_interval&&a.distance<b.options.doubletap_distance&&(b.trigger(\"doubletap\",a),e=!0),(!e||b.options.tap_always)&&(d.detection.current.name=\"tap\",b.trigger(d.detection.current.name,a))}}},d.gestures.Touch={name:\"touch\",index:-1/0,defaults:{prevent_default:!1,prevent_mouseevents:!1},handler:function(a,b){return b.options.prevent_mouseevents&&a.pointerType==d.POINTER_MOUSE?(a.stopDetect(),void 0):(b.options.prevent_default&&a.preventDefault(),a.eventType==d.EVENT_START&&b.trigger(this.name,a),void 0)}},d.gestures.Transform={name:\"transform\",index:45,defaults:{transform_min_scale:.01,transform_min_rotation:1,transform_always_block:!1},triggered:!1,handler:function(a,b){if(d.detection.current.name!=this.name&&this.triggered)return b.trigger(this.name+\"end\",a),this.triggered=!1,void 0;if(!(a.touches.length<2))switch(b.options.transform_always_block&&a.preventDefault(),a.eventType){case d.EVENT_START:this.triggered=!1;break;case d.EVENT_MOVE:var c=Math.abs(1-a.scale),e=Math.abs(a.rotation);if(c<b.options.transform_min_scale&&e<b.options.transform_min_rotation)return;d.detection.current.name=this.name,this.triggered||(b.trigger(this.name+\"start\",a),this.triggered=!0),b.trigger(this.name,a),e>b.options.transform_min_rotation&&b.trigger(\"rotate\",a),c>b.options.transform_min_scale&&(b.trigger(\"pinch\",a),b.trigger(\"pinch\"+(a.scale<1?\"in\":\"out\"),a));break;case d.EVENT_END:this.triggered&&b.trigger(this.name+\"end\",a),this.triggered=!1}}},\"function\"==typeof define&&\"object\"==typeof define.amd&&define.amd?define(function(){return d}):\"object\"==typeof module&&\"object\"==typeof module.exports?module.exports=d:a.Hammer=d}(this);\n\n// Game script\ndocument.addEventListener(\"DOMContentLoaded\", function () {\n  // Wait till the browser is ready to render the game (avoids glitches)\n  window.requestAnimationFrame(function () {\n    var manager = new GameManager(4, KeyboardInputManager, HTMLActuator);\n  });\n});\n\nfunction GameManager(size, InputManager, Actuator) {\n  this.size         = size; // Size of the grid\n  this.inputManager = new InputManager;\n  this.actuator     = new Actuator;\n  this.startTiles   = 2;\n  this.inputManager.on(\"move\", this.move.bind(this));\n  this.inputManager.on(\"restart\", this.restart.bind(this));\n  this.setup();\n}\n\n// Restart the game\nGameManager.prototype.restart = function () {\n  this.actuator.restart();\n  this.setup();\n};\n\n// Set up the game\nGameManager.prototype.setup = function () {\n  this.grid         = new Grid(this.size);\n  this.score        = 0;\n  this.over         = false;\n  this.won          = false;\n\n  // Add the initial tiles\n  this.addStartTiles();\n\n  // Update the actuator\n  this.actuate();\n};\n\n// Set up the initial tiles to start the game with\nGameManager.prototype.addStartTiles = function () {\n  for (var i = 0; i < this.startTiles; i++) {\n    this.addRandomTile();\n  }\n};\n\n// Adds a tile in a random position\nGameManager.prototype.addRandomTile = function () {\n  if (this.grid.cellsAvailable()) {\n    var value = Math.random() < 0.9 ? 2 : 4;\n    var tile = new Tile(this.grid.randomAvailableCell(), value);\n\n    this.grid.insertTile(tile);\n  }\n};\n\n// Sends the updated grid to the actuator\nGameManager.prototype.actuate = function () {\n  this.actuator.actuate(this.grid, {\n    score: this.score,\n    over:  this.over,\n    won:   this.won\n  });\n};\n\n// Save all tile positions and remove merger info\nGameManager.prototype.prepareTiles = function () {\n  this.grid.eachCell(function (x, y, tile) {\n    if (tile) {\n      tile.mergedFrom = null;\n      tile.savePosition();\n    }\n  });\n};\n\n// Move a tile and its representation\nGameManager.prototype.moveTile = function (tile, cell) {\n  this.grid.cells[tile.x][tile.y] = null;\n  this.grid.cells[cell.x][cell.y] = tile;\n  tile.updatePosition(cell);\n};\n\n// Move tiles on the grid in the specified direction\nGameManager.prototype.move = function (direction) {\n  // 0: up, 1: right, 2:down, 3: left\n  var self = this;\n\n  if (this.over || this.won) return; // Don\'t do anything if the game\'s over\n\n  var cell, tile;\n\n  var vector     = this.getVector(direction);\n  var traversals = this.buildTraversals(vector);\n  var moved      = false;\n\n  // Save the current tile positions and remove merger information\n  this.prepareTiles();\n\n  // Traverse the grid in the right direction and move tiles\n  traversals.x.forEach(function (x) {\n    traversals.y.forEach(function (y) {\n      cell = { x: x, y: y };\n      tile = self.grid.cellContent(cell);\n\n      if (tile) {\n        var positions = self.findFarthestPosition(cell, vector);\n        var next      = self.grid.cellContent(positions.next);\n\n        // Only one merger per row traversal?\n        if (next && next.value === tile.value && !next.mergedFrom) {\n          var merged = new Tile(positions.next, tile.value * 2);\n          merged.mergedFrom = [tile, next];\n\n          self.grid.insertTile(merged);\n          self.grid.removeTile(tile);\n\n          // Converge the two tiles\' positions\n          tile.updatePosition(positions.next);\n\n          // Update the score\n          self.score += merged.value;\n\n          // The mighty 2048 tile\n          if (merged.value === 2048) self.won = true;\n        } else {\n          self.moveTile(tile, positions.farthest);\n        }\n\n        if (!self.positionsEqual(cell, tile)) {\n          moved = true; // The tile moved from its original cell!\n        }\n      }\n    });\n  });\n\n  if (moved) {\n    this.addRandomTile();\n\n    if (!this.movesAvailable()) {\n      this.over = true; // Game over!\n    }\n\n    this.actuate();\n  }\n};\n\n// Get the vector representing the chosen direction\nGameManager.prototype.getVector = function (direction) {\n  // Vectors representing tile movement\n  var map = {\n    0: { x: 0,  y: -1 }, // up\n    1: { x: 1,  y: 0 },  // right\n    2: { x: 0,  y: 1 },  // down\n    3: { x: -1, y: 0 }   // left\n  };\n\n  return map[direction];\n};\n\n// Build a list of positions to traverse in the right order\nGameManager.prototype.buildTraversals = function (vector) {\n  var traversals = { x: [], y: [] };\n\n  for (var pos = 0; pos < this.size; pos++) {\n    traversals.x.push(pos);\n    traversals.y.push(pos);\n  }\n\n  // Always traverse from the farthest cell in the chosen direction\n  if (vector.x === 1) traversals.x = traversals.x.reverse();\n  if (vector.y === 1) traversals.y = traversals.y.reverse();\n\n  return traversals;\n};\n\nGameManager.prototype.findFarthestPosition = function (cell, vector) {\n  var previous;\n\n  // Progress towards the vector direction until an obstacle is found\n  do {\n    previous = cell;\n    cell     = { x: previous.x + vector.x, y: previous.y + vector.y };\n  } while (this.grid.withinBounds(cell) &&\n           this.grid.cellAvailable(cell));\n\n  return {\n    farthest: previous,\n    next: cell // Used to check if a merge is required\n  };\n};\n\nGameManager.prototype.movesAvailable = function () {\n  return this.grid.cellsAvailable() || this.tileMatchesAvailable();\n};\n\n// Check for available matches between tiles (more expensive check)\nGameManager.prototype.tileMatchesAvailable = function () {\n  var self = this;\n\n  var tile;\n\n  for (var x = 0; x < this.size; x++) {\n    for (var y = 0; y < this.size; y++) {\n      tile = this.grid.cellContent({ x: x, y: y });\n\n      if (tile) {\n        for (var direction = 0; direction < 4; direction++) {\n          var vector = self.getVector(direction);\n          var cell   = { x: x + vector.x, y: y + vector.y };\n\n          var other  = self.grid.cellContent(cell);\n          if (other) {\n          }\n\n          if (other && other.value === tile.value) {\n            return true; // These two tiles can be merged\n          }\n        }\n      }\n    }\n  }\n\n  return false;\n};\n\nGameManager.prototype.positionsEqual = function (first, second) {\n  return first.x === second.x && first.y === second.y;\n};\n\nfunction Grid(size) {\n  this.size = size;\n\n  this.cells = [];\n\n  this.build();\n}\n\n// Build a grid of the specified size\nGrid.prototype.build = function () {\n  for (var x = 0; x < this.size; x++) {\n    var row = this.cells[x] = [];\n\n    for (var y = 0; y < this.size; y++) {\n      row.push(null);\n    }\n  }\n};\n\n// Find the first available random position\nGrid.prototype.randomAvailableCell = function () {\n  var cells = this.availableCells();\n\n  if (cells.length) {\n    return cells[Math.floor(Math.random() * cells.length)];\n  }\n};\n\nGrid.prototype.availableCells = function () {\n  var cells = [];\n\n  this.eachCell(function (x, y, tile) {\n    if (!tile) {\n      cells.push({ x: x, y: y });\n    }\n  });\n\n  return cells;\n};\n\n// Call callback for every cell\nGrid.prototype.eachCell = function (callback) {\n  for (var x = 0; x < this.size; x++) {\n    for (var y = 0; y < this.size; y++) {\n      callback(x, y, this.cells[x][y]);\n    }\n  }\n};\n\n// Check if there are any cells available\nGrid.prototype.cellsAvailable = function () {\n  return !!this.availableCells().length;\n};\n\n// Check if the specified cell is taken\nGrid.prototype.cellAvailable = function (cell) {\n  return !this.cellOccupied(cell);\n};\n\nGrid.prototype.cellOccupied = function (cell) {\n  return !!this.cellContent(cell);\n};\n\nGrid.prototype.cellContent = function (cell) {\n  if (this.withinBounds(cell)) {\n    return this.cells[cell.x][cell.y];\n  } else {\n    return null;\n  }\n};\n\n// Inserts a tile at its position\nGrid.prototype.insertTile = function (tile) {\n  this.cells[tile.x][tile.y] = tile;\n};\n\nGrid.prototype.removeTile = function (tile) {\n  this.cells[tile.x][tile.y] = null;\n};\n\nGrid.prototype.withinBounds = function (position) {\n  return position.x >= 0 && position.x < this.size &&\n         position.y >= 0 && position.y < this.size;\n};\n\nfunction HTMLActuator() {\n  this.tileContainer    = document.getElementsByClassName(\"tile-container\")[0];\n  this.scoreContainer   = document.getElementsByClassName(\"score-container\")[0];\n  this.messageContainer = document.getElementsByClassName(\"game-message\")[0];\n\n  this.score = 0;\n}\n\nHTMLActuator.prototype.actuate = function (grid, metadata) {\n  var self = this;\n\n  window.requestAnimationFrame(function () {\n    self.clearContainer(self.tileContainer);\n\n    grid.cells.forEach(function (column) {\n      column.forEach(function (cell) {\n        if (cell) {\n          self.addTile(cell);\n        }\n      });\n    });\n\n    self.updateScore(metadata.score);\n\n    if (metadata.over) self.message(false); // You lose\n    if (metadata.won) self.message(true); // You win!\n  });\n};\n\nHTMLActuator.prototype.restart = function () {\n  this.clearMessage();\n};\n\nHTMLActuator.prototype.clearContainer = function (container) {\n  while (container.firstChild) {\n    container.removeChild(container.firstChild);\n  }\n};\n\nHTMLActuator.prototype.addTile = function (tile) {\n  var self = this;\n\n  var element   = document.createElement(\"div\");\n  var position  = tile.previousPosition || { x: tile.x, y: tile.y };\n  positionClass = this.positionClass(position);\n\n  // We can\'t use classlist because it somehow glitches when replacing classes\n  var classes = [\"tile\", \"tile-\" + tile.value, positionClass];\n  this.applyClasses(element, classes);\n\n  element.textContent = tile.value;\n\n  if (tile.previousPosition) {\n    // Make sure that the tile gets rendered in the previous position first\n    window.requestAnimationFrame(function () {\n      classes[2] = self.positionClass({ x: tile.x, y: tile.y });\n      self.applyClasses(element, classes); // Update the position\n    });\n  } else if (tile.mergedFrom) {\n    classes.push(\"tile-merged\");\n    this.applyClasses(element, classes);\n\n    // Render the tiles that merged\n    tile.mergedFrom.forEach(function (merged) {\n      self.addTile(merged);\n    });\n  } else {\n    classes.push(\"tile-new\");\n    this.applyClasses(element, classes);\n  }\n\n  // Put the tile on the board\n  this.tileContainer.appendChild(element);\n};\n\nHTMLActuator.prototype.applyClasses = function (element, classes) {\n  element.setAttribute(\"class\", classes.join(\" \"));\n};\n\nHTMLActuator.prototype.normalizePosition = function (position) {\n  return { x: position.x + 1, y: position.y + 1 };\n};\n\nHTMLActuator.prototype.positionClass = function (position) {\n  position = this.normalizePosition(position);\n  return \"tile-position-\" + position.x + \"-\" + position.y;\n};\n\nHTMLActuator.prototype.updateScore = function (score) {\n  this.clearContainer(this.scoreContainer);\n\n  var difference = score - this.score;\n  this.score = score;\n\n  this.scoreContainer.textContent = this.score;\n\n  if (difference > 0) {\n    var addition = document.createElement(\"div\");\n    addition.classList.add(\"score-addition\");\n    addition.textContent = \"+\" + difference;\n\n    this.scoreContainer.appendChild(addition);\n  }\n};\n\nHTMLActuator.prototype.message = function (won) {\n  var type    = won ? \"game-won\" : \"game-over\";\n  var message = won ? \"You win!\" : \"Game over!\"\n\n  // if (ga) ga(\"send\", \"event\", \"game\", \"end\", type, this.score);\n\n  this.messageContainer.classList.add(type);\n  this.messageContainer.getElementsByTagName(\"p\")[0].textContent = message;\n};\n\nHTMLActuator.prototype.clearMessage = function () {\n  this.messageContainer.classList.remove(\"game-won\", \"game-over\");\n};\n\nfunction KeyboardInputManager() {\n  this.events = {};\n\n  this.listen();\n}\n\nKeyboardInputManager.prototype.on = function (event, callback) {\n  if (!this.events[event]) {\n    this.events[event] = [];\n  }\n  this.events[event].push(callback);\n};\n\nKeyboardInputManager.prototype.emit = function (event, data) {\n  var callbacks = this.events[event];\n  if (callbacks) {\n    callbacks.forEach(function (callback) {\n      callback(data);\n    });\n  }\n};\n\nKeyboardInputManager.prototype.listen = function () {\n  var self = this;\n\n  var map = {\n    38: 0, // Up\n    39: 1, // Right\n    40: 2, // Down\n    37: 3, // Left\n    75: 0, // vim keybindings\n    76: 1,\n    74: 2,\n    72: 3\n  };\n\n  document.addEventListener(\"keydown\", function (event) {\n    var modifiers = event.altKey || event.ctrlKey || event.metaKey ||\n                    event.shiftKey;\n    var mapped    = map[event.which];\n\n    if (!modifiers) {\n      if (mapped !== undefined) {\n        event.preventDefault();\n        self.emit(\"move\", mapped);\n      }\n\n      if (event.which === 32) self.restart.bind(self)(event);\n    }\n  });\n\n  var retry = document.getElementsByClassName(\"retry-button\")[0];\n  retry.addEventListener(\"click\", this.restart.bind(this));\n\n  // Listen to swipe events\n  var gestures = [Hammer.DIRECTION_UP, Hammer.DIRECTION_RIGHT,\n                  Hammer.DIRECTION_DOWN, Hammer.DIRECTION_LEFT];\n\n  var gameContainer = document.getElementsByClassName(\"game-container\")[0];\n  var handler       = Hammer(gameContainer, {\n    drag_block_horizontal: true,\n    drag_block_vertical: true\n  });\n\n  handler.on(\"swipe\", function (event) {\n    event.gesture.preventDefault();\n    mapped = gestures.indexOf(event.gesture.direction);\n\n    if (mapped !== -1) self.emit(\"move\", mapped);\n  });\n};\n\nKeyboardInputManager.prototype.restart = function (event) {\n  event.preventDefault();\n  this.emit(\"restart\");\n};\n\nfunction Tile(position, value) {\n  this.x                = position.x;\n  this.y                = position.y;\n  this.value            = value || 2;\n\n  this.previousPosition = null;\n  this.mergedFrom       = null; // Tracks tiles that merged together\n}\n\nTile.prototype.savePosition = function () {\n  this.previousPosition = { x: this.x, y: this.y };\n};\n\nTile.prototype.updatePosition = function (position) {\n  this.x = position.x;\n  this.y = position.y;\n};\n</script>\n</body>\n</html>';
};

export default get2048HTML();
